<?php

function display_prop_thumb($prop_id) {
	// make pdo connection
	// select statement where prop_id = $prop_id
	// spit all property data out

	$dbc = new PDO('oci:dbname=FIT2076', 's26244608', 'monash00');
	$dbc->setAttribute(PDO::ATTR_CASE, PDO::CASE_LOWER);

	try {
		// select property to display
		$query = "select * from property where prop_id = :prop_id";
		$stmt = $dbc->prepare($query);

		$stmt->bindParam(":prop_id", $prop_id);
		$stmt->execute();

		$res = $stmt->fetch();

// PROP_ID     NOT NULL NUMBER        
// PROP_STREET NOT NULL VARCHAR2(100) 
// PROP_SUBURB NOT NULL VARCHAR2(50)  
// PROP_STATE  NOT NULL VARCHAR2(5)   
// PROP_PC     NOT NULL NUMBER        
// PROP_TYPE   NOT NULL NUMBER        

		$prop_title = $res["prop_street"] . ", "
					. $res["prop_suburb"] . ", "
					. $res["prop_state"] . " "
					. $res["prop_pc"];

		$query = "select * from property_type where type_id = " . $res["prop_type"];

		$stmt = $dbc->prepare($query);
		$stmt->execute();

		$type = $stmt->fetch();

		$href = "property_details.php?prop=" . $prop_id . "&action=update";

		$img_query = "select * from property_image where prop_id = " . $prop_id;
		$img_stmt = $dbc->prepare($img_query);
		$img_stmt->execute();

		$img_thumb = $img_stmt->fetch();
?>
			<div class="prop-thumb">
				<div class="float-box"><img class="prop-thumb-img" src="property_imgs/<?php echo $img_thumb["img_path"]; ?>" /></div>
				<div class="float-box">
					<a class="prop-thumb-title" href="<?php echo $href; ?>"><?php echo $prop_title; ?></a>
					<p class="prop-thumb-type">Type: <?php echo $type["type_name"]; ?></p>
					<p class="prop-thumb-desc">Description</p>
				</div>
				<div class="float-box float-right">
					<div class="prop-thumb-edit">
					<a href="<?php// echo $href; ?>">Edit</a>
					</div>
					<div class="prop-thumb-delete">
					<a href="index.php?action=delete&prop=<?php echo $prop_id; ?>">Delete</a>
					</div>
				</div>
			</div>
<?php
	}
	catch (Exception $e) {
		die($e->getMessage());
	}
}
?>
